<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_school_trip_template">
        <t t-call="web.external_layout">
            <main>
                <t t-foreach="docs" t-as="o">

                    <div class="page" style="direction: rtl; text-align: right; font-family: 'Arial', sans-serif; line-height: 2; padding: 20px;">

                        <!-- ุฑูู ุงูุทูุจ -->
                        <p style="text-align:left; font-size:13px; color:#555;">
                            <strong>ุฑูู ุงูุทูุจ:</strong> <span t-esc="o.name"/>
                        </p>

                        <!-- ุงูุนููุงู ุงูุฑุฆูุณู -->
                        <h2 style="text-align:center; font-weight:bold; margin-bottom:15px; text-decoration: underline; font-size:20px;">
                            ูููุฐุฌ ุทูุจ ุฑุญูุฉ ูุฏุฑุณูุฉ
                        </h2>

                        <p style="margin-bottom:20px; font-size:15px;">
                            ูุฑุฌู ุชูููุฑ ูุณููุฉ ููุงุตูุงุช ุญุณุจ ุงูุจูุงูุงุช ุฃุฏูุงู:
                        </p>

                        <!-- ุจูุงูุงุช ุงูุฑุญูุฉ -->
                        <table style="width:100%; border-collapse:collapse; font-size:15px; border:1px solid #000;">
                            <tr>
                                <td style="border:1px solid #000; width:30%; padding:8px;"><strong>ููุน ุงูุฑุญูุฉ:</strong></td>
                                <td style="border:1px solid #000; width:70%; padding:8px;">
                                    <t t-if="o.trip_type == 'activity'">ุฑุญูุฉ ูุดุงุท ุทูุงุจูุฉ</t>
                                    <t t-if="o.trip_type == 'evening'">ุฏูุฑุฉ ูุณุงุฆูุฉ</t>
                                    <t t-if="o.trip_type == 'other'">ุฃุฎุฑู</t>
                                </td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ุชุงุฑูุฎ ุงูุฑุญูุฉ:</strong></td>
                                <td style="border:1px solid #000; padding:8px;">
                                    <span t-field="o.date_from" t-options="{'widget': 'date', 'format': 'yyyy/MM/dd'}"/>
                                </td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ุงูููู:</strong></td>
                                <td style="border:1px solid #000; padding:8px;"><span t-esc="o.day_name"/></td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ุนุฏุฏ ุงูุทูุงุจ:</strong></td>
                                <td style="border:1px solid #000; padding:8px;"><span t-esc="o.students_count"/></td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ุนุฏุฏ ุงูุญุงููุงุช:</strong></td>
                                <td style="border:1px solid #000; padding:8px;"><span t-esc="o.buses_count"/></td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ูู:</strong></td>
                                <td style="border:1px solid #000; padding:8px;">
                                    <!-- โ FIX: ุนุฑุถ ุฃุณูุงุก ุงููุฏุงุฑุณ ุจุดูู ุตุญูุญ -->
                                    <span t-esc="o.school_names"/>
                                </td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ุฅูู:</strong></td>
                                <td style="border:1px solid #000; padding:8px;"><span t-esc="o.direction_to"/></td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ุงูุบุฑุถ ูู ุงูุฑุญูุฉ:</strong></td>
                                <td style="border:1px solid #000; padding:8px;"><span t-esc="o.trip_purpose"/></td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ุงููุฑุญูุฉ ุงูุฏุฑุงุณูุฉ:</strong></td>
                                <td style="border:1px solid #000; padding:8px;">
                                    <t t-if="o.stage == 'kg'">ุฑูุถู</t>
                                    <t t-if="o.stage == 'primary'">ุงูุงุจุชุฏุงุฆูุฉ</t>
                                    <t t-if="o.stage == 'middle'">ุงููุชูุณุทุฉ</t>
                                    <t t-if="o.stage == 'secondary'">ุงูุซุงูููุฉ</t>
                                </td>
                            </tr>
                        </table>

                        <!-- ุจูุงูุงุช ููุฏู ุงูุทูุจ -->
                        <br/>
                        <h4 style="text-decoration: underline; font-size:16px; margin-bottom:6px;">ุจูุงูุงุช ููุฏู ุงูุทูุจ:</h4>
                        <table style="width:100%; border-collapse:collapse; font-size:15px; border:1px solid #000;">
                            <tr>
                                <td style="width:30%; border:1px solid #000; padding:8px;"><strong>ุงุณู ููุฏู ุงูุทูุจ:</strong></td>
                                <td style="border:1px solid #000; padding:8px;"><span t-esc="o.applicant_name"/></td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ุฌูุงู ููุฏู ุงูุทูุจ:</strong></td>
                                <td style="border:1px solid #000; padding:8px;"><span t-esc="o.applicant_mobile"/></td>
                            </tr>
                        </table>

                        <!-- ุงุนุชูุงุฏ ุงูููุงุฏุฉ ูุงูููู -->
                        <br/>
                        <h4 style="text-decoration: underline; font-size:16px; margin-bottom:6px;">ุงุนุชูุงุฏ ูุงุฆุฏ ุงููุฏุฑุณุฉ ููุณุคูู ุงูููู:</h4>
                        <table style="width:100%; border-collapse:collapse; font-size:15px; border:1px solid #000;">
                            <tr>
                                <td style="width:30%; border:1px solid #000; padding:8px;"><strong>ุงุณู ูุงุฆุฏ ุงููุฏุฑุณุฉ:</strong></td>
                                <td style="border:1px solid #000; padding:8px;"><span t-esc="o.school_leader_name"/></td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #000; padding:8px;"><strong>ุงุนุชูุงุฏ ูุณุคูู ุงูููู:</strong></td>
                                <td style="border:1px solid #000; padding:8px;">
                                    <t t-if="o.transport_approval">โ ุชู ุงูุงุนุชูุงุฏ</t>
                                    <t t-if="not o.transport_approval">โ ูู ูุชู ุงูุงุนุชูุงุฏ</t>
                                </td>
                            </tr>
                        </table>

                        <!-- โ ุชูุงุตูู ุงูุญุงููุงุช (ุฅู ูุฌุฏุช) -->
                        <t t-if="o.bus_line_ids and o.state == 'approved'">
                            <br/>
                            <h4 style="text-decoration: underline; font-size:16px; margin-bottom:6px;">ุชูุงุตูู ุงูุญุงููุงุช:</h4>
                            <table style="width:100%; border-collapse:collapse; font-size:14px; border:1px solid #000;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="border:1px solid #000; padding:6px; text-align:center;">#</th>
                                        <th style="border:1px solid #000; padding:6px;">ุงูุญุงููุฉ</th>
                                        <th style="border:1px solid #000; padding:6px;">ุฑูู ุงูููุญุฉ</th>
                                        <th style="border:1px solid #000; padding:6px;">ุงูุณุงุฆู</th>
                                        <th style="border:1px solid #000; padding:6px;">ุฌูุงู ุงูุณุงุฆู</th>
                                        <th style="border:1px solid #000; padding:6px;">ุงูููุงุนุฏ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="o.bus_line_ids" t-as="bus">
                                        <tr>
                                            <td style="border:1px solid #000; padding:6px; text-align:center;">
                                                <span t-esc="bus_index + 1"/>
                                            </td>
                                            <td style="border:1px solid #000; padding:6px;">
                                                <span t-esc="bus.vehicle_id.name"/>
                                            </td>
                                            <td style="border:1px solid #000; padding:6px;">
                                                <span t-esc="bus.license_plate"/>
                                            </td>
                                            <td style="border:1px solid #000; padding:6px;">
                                                <span t-esc="bus.driver_id.name or 'ุบูุฑ ูุญุฏุฏ'"/>
                                            </td>
                                            <td style="border:1px solid #000; padding:6px;">
                                                <span t-esc="bus.driver_mobile or '-'"/>
                                            </td>
                                            <td style="border:1px solid #000; padding:6px; text-align:center;">
                                                <span t-esc="bus.seats"/>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </t>

                        <!-- โ ูุนูููุงุช ุงููุนุงููุฉ ุงููุฑุชุจุทุฉ (ุฅู ูุฌุฏุช) -->
                        <t t-if="o.event_id">
                            <br/>
                            <div style="border: 2px solid #4CAF50; padding: 10px; background-color: #f9fff9; border-radius: 5px;">
                                <p style="margin: 0; font-size: 14px;">
                                    <strong>๐ ุงููุนุงููุฉ ุงููุฑุชุจุทุฉ:</strong> 
                                    <span t-esc="o.event_id.name"/>
                                </p>
                            </div>
                        </t>

                        <!-- ุงูููุงุญุธุฉ -->
                        <div style="margin-top:35px; border-top:1px dashed #000; padding-top:10px; font-size:14px;">
                            <p><strong>ููุงุญุธุฉ:</strong> ูุฌุจ ุชูุฏูู ุงูุทูุจ ูุจู ุงูุฑุญูุฉ ุจููู ุนูู ุงูุฃูู.</p>
                        </div>

                        <!-- ุงูุชูููุนุงุช -->
                        <div style="margin-top:40px;">
                            <table style="width:100%; font-size:14px;">
                                <tr>
                                    <td style="width:33%; text-align:center; border-bottom:1px solid #000; padding:50px 0 5px 0;">
                                        <div>ุชูููุน ููุฏู ุงูุทูุจ</div>
                                    </td>
                                    <td style="width:33%; text-align:center; border-bottom:1px solid #000; padding:50px 0 5px 0;">
                                        <div>ุชูููุน ูุงุฆุฏ ุงููุฏุฑุณุฉ</div>
                                    </td>
                                    <td style="width:33%; text-align:center; border-bottom:1px solid #000; padding:50px 0 5px 0;">
                                        <div>ุชูููุน ูุณุคูู ุงูููู</div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </t>
            </main>
        </t>
    </template>

    <!-- ุชุนุฑูู ุงูุชูุฑูุฑ -->
    <report
        id="action_school_trip_report_pdf"
        model="school.trip.request"
        string="ูููุฐุฌ ุทูุจ ุฑุญูุฉ ูุฏุฑุณูุฉ"
        report_type="qweb-pdf"
        name="kb_school_trip_request.report_school_trip_template"
        file="kb_school_trip_request.report_school_trip_template"
        print_report_name="'ุทูุจ ุฑุญูุฉ ูุฏุฑุณูุฉ - %s' % (object.name)"
    />
</odoo>